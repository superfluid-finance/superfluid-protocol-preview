# Migration `20201030031119-migration`

This migration has been generated by Patrick at 10/29/2020, 11:11:19 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "User" (
    "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
    "address" TEXT NOT NULL,
    "name" TEXT,
    "createdAt" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
)

CREATE TABLE "Bid" (
    "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
    "auctionAddress" TEXT NOT NULL,
    "ownerAddress" TEXT NOT NULL,

    FOREIGN KEY ("auctionAddress") REFERENCES "Auction"("address") ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY ("ownerAddress") REFERENCES "User"("address") ON DELETE CASCADE ON UPDATE CASCADE
)

CREATE TABLE "Auction" (
    "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
    "address" TEXT NOT NULL,
    "name" TEXT NOT NULL,
    "description" TEXT,
    "createdAt" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "status" TEXT NOT NULL DEFAULT 'started',
    "highBid" INTEGER NOT NULL DEFAULT 0,
    "generation" INTEGER NOT NULL DEFAULT 0,
    "revenue" INTEGER NOT NULL DEFAULT 0,
    "ownerAddress" TEXT NOT NULL,

    FOREIGN KEY ("ownerAddress") REFERENCES "User"("address") ON DELETE CASCADE ON UPDATE CASCADE
)

CREATE UNIQUE INDEX "User.address_unique" ON "User"("address")

CREATE UNIQUE INDEX "Auction.address_unique" ON "Auction"("address")
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20201030031119-migration
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,46 @@
+datasource DS {
+  // optionally set multiple providers
+  // example: provider = ["sqlite", "postgresql"]
+  provider = "sqlite"
+  url = "***"
+}
+
+generator client {
+  provider      = "prisma-client-js"
+  binaryTargets = ["native", "rhel-openssl-1.0.x"]
+}
+
+// Define your own datamodels here and run `yarn redwood db save` to create
+// migrations for them.
+
+model User {
+  id Int @id @default(autoincrement())
+  address String @unique
+  name  String?
+  createdAt  DateTime  @default(now())
+  auctions Auction[]
+  bids Bid[]
+}
+
+model Bid {
+  id Int @id @default(autoincrement())
+  auction Auction @relation(fields: [auctionAddress], references: [address])
+  auctionAddress String
+  owner User @relation(fields: [ownerAddress], references: [address])
+  ownerAddress String
+}
+
+model Auction {
+  id Int @id @default(autoincrement())
+  address String @unique
+  name String
+  description String?
+  createdAt  DateTime  @default(now())
+  status String @default("started")
+  highBid Int @default(0)
+  generation Int @default(0)
+  revenue Int @default(0)
+  owner User @relation(fields: [ownerAddress], references: [address])
+  ownerAddress String
+  bids Bid[]
+}
```


